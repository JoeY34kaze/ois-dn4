<!DOCTYPE html>
<html>
    <head>
        <script src ="http://d3js.org/d3.v3.min.js"></script>
    </head>
    <body onload="init()">
    bla
    <script>
    var baseUrl = 'https://rest.ehrscape.com/rest/v1';
    var queryUrl = baseUrl + '/query';
    var username = "ois.seminar";
    var password = "ois4fri";
    
    var bolnikData1=[];
    var bolnikData2=[];
    
    console.log("inside iframe");
    
    
    function getT(ehrId){
        console.log("inside getT");
        sessionId = getSessionId();
        
        $.ajax({
		url: baseUrl + "/demographics/ehr/" + ehrId + "/party",
    	type: 'GET',
    	headers: {"Ehr-Session": sessionId},
    	success: function (data) {
			var party = data.party;
			$.ajax({
			    url: baseUrl + "/view/" + ehrId + "/" + "weight",
			    type: 'GET',
			    headers: {"Ehr-Session": sessionId},
			    success: function (res) {
			    	if (res.length > 0) {
			    		// res je 0
				        for (var i=0;i<res.length;i++) {
				        			console.log("5");
				        	bolnikData1[i]=res[res.length-1-i].weight;
				        	bolnikData2[i]=res[res.length-1-i].time;

				           
				            
				            		console.log(" \n iframe: "+res[i].time+"   "+res[i].weight + "   " 	+ res[i].unit);
				            		
				            		
				            		//narisat graf v #grafi
				            		d3.select("body").append("p").text("d3 izpis: "+res[i].time+"   "+res[i].weight + "   " 	+ res[i].unit);
				            		
				            		
				            		
				            		
				        }
				     
			    	} else {

			    	}
			    },
			    error: function() {
					console.log(JSON.parse(err.responseText).userMessage);
			    }
			});					
			
    	},
    	error: function(err) {
			console.log(JSON.parse(err.responseText).userMessage);
    	}
	});
        
    }
    
    function getSessionId() {
    var response = $.ajax({
        type: "POST",
        url: baseUrl + "/session?username=" + encodeURIComponent(username) +
                "&password=" + encodeURIComponent(password),
        async: false
    });
    return response.responseJSON.sessionId;
}
    
    
    
    
    
    function init(){
        var canvas=d3.select("body")
					.append("svg")
					.attr("width", 500)
			    	.attr("height",500);
												
		var circle = canvas.append("circle")
						.attr("cx",100)
						.attr("cy", 100)
						.attr("r", 50)
						.attr("fill", "red");
    }
    
    
    /*
        d3.select("body").append("p").text("yoo")
       // var data=main.js.bolnikData1;
        											var canvas=d3.select("body")
												.append("svg")
												.attr("width", 500)
												.attr("height",500);
												
											var circle = canvas.append("circle")
															.attr("cx",100)
															.attr("cy", 100)
															.attr("r", 50)
															.attr("fill", "red");
															
															*/
															
    </script>
    </body>
</html>